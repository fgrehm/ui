<style type="text/css" media="screen">
  .calendar { font: 10px Helvetica; }
  .calendar .days th { background-color: #555; color: #eee; width: 20px; }
  .calendar tbody td { background-color: #eee; height: 20px; vertical-align: top; width: 20px; }

  .calendar td.events { background-color: #ffc; }
  .calendar td.events .date { font-weight: bold; }
  .calendar .milestone { color: #090; }
  .calendar .deadline { color: #900; }
</style>

<% @calendar.months.each do |month| %>
<table class="calendar">
  <thead>
    <tr class="month">
      <th colspan="7"><%= month.to_s %></th>
    </tr>
    <tr class="days">
      <th>S</th>
      <th>M</th>
      <th>T</th>
      <th>W</th>
      <th>T</th>
      <th>F</th>
      <th>S</th>
    </tr>
  </thead>
  <tbody>
    <% month.to_a.each do |week| %>
    <tr>
      <% week.each do |day| %>
      <% if day.nil? %>
      <td></td>
      <% else %>
      <% events = @calendar.events.find_all { |event| event.on?(day) } %>
      <td <%= 'class="events"' unless events.empty? %>>
        <span class="date"><%= day.day %></span>
        <div class="events" style="display: none">
        <% events.each do |event| %>
          <span class="event <%= event.type || "" %>"><%= event.title %></span>
        <% end %>
        </div>
      </td>
      <% end # if day.nil? %>
      <% end %>
    </tr>
    <% end %>
  </tbody>
</table>
<% end %>